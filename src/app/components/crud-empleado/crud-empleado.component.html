<div class="wrapper">
    <app-barra-lateral></app-barra-lateral>
    <div class="main">
        <nav class="navbar navbar-expand-lg p-0" style="background-color: #001f3f;">
            <div class="container-fluid p-0">
                <a class="navbar-brand" href="/home">
                    <img src="logo/logoLexVargasV.png" alt="LexVargas Logo" width="200" class="d-inline-block align-text-top">
                </a>
            </div>
        </nav>

        <div class="p-3">

          <app-breadcrumbs></app-breadcrumbs>

            <div class="cuerpo">
                <div class="row mb-4 align-items-center">
                    <div class="col-md-8">
                        <h2 class="titulo-empleados">Empleados</h2>
                    </div>
                    <div class="col-md-4 text-end">
                        <button type="button" class="btn btn-success" (click)="abrirModalNuevoEmpleado()">Nuevo Empleado</button>
                    </div>
                </div>

  
          <!-- Filtros -->
          <div class="filtros-container filtros">
            <h3>Filtros de Empleados</h3>
            <div class="filtros-content">
              <div class="form-group">
                <label for="filtroNombre">Nombre del Empleado:</label>
                <input type="text" id="filtroNombre" class="form-control filtro-input" [(ngModel)]="filtroNombre" (input)="filtrarEmpleados()" placeholder="Buscar por nombre...">
              </div>
              <div class="form-group">
                <label for="filtroCorreo">Correo del Empleado:</label>
                <input type="text" id="filtroCorreo" class="form-control filtro-input" [(ngModel)]="filtroCorreo" (input)="filtrarEmpleados()" placeholder="Buscar por correo...">
              </div>
              <div class="form-group">
                <label for="filtroTelefono">Teléfono del Empleado:</label>
                <input type="text" id="filtroTelefono" class="form-control filtro-input" [(ngModel)]="filtroTelefono" (input)="filtrarEmpleados()" placeholder="Buscar por teléfono...">
              </div>
              <div class="form-group">
                <label for="filtroRol">Rol:</label>
                <select id="filtroRol" class="form-control filtro-select" [(ngModel)]="filtroRol" (change)="filtrarEmpleados()">
                  <option value="">Todos los Roles</option>
                  <option *ngFor="let rol of rolService.roles" [value]="rol.idRol">{{ rol.nombreRol }}</option>
                </select>
              </div>
              <div class="form-group">
                <label for="filtroEspecialidad">Especialidad:</label>
                <select id="filtroEspecialidad" class="form-control filtro-select" [(ngModel)]="filtroEspecialidad" (change)="filtrarEmpleados()">
                  <option value="">Todas las Especialidades</option>
                  <option *ngFor="let especialidad of especialidadService.especialidades" [value]="especialidad.idEspecialidad">{{ especialidad.nombreEspecialidad }}</option>
                </select>
              </div>
            </div>
          </div>
          
          
          <div class="row">
            <div class="col-md-3" *ngFor="let itemE of empleadosFiltrados">
              <div class="card mb-4">
                <div class="card-body text-center">
                  <h5 class="card-title">
                    <strong>{{ itemE.nombreEmpleado }}</strong>
                  </h5>
                  <h5 class="card-title">
                    <strong>{{ itemE.aPEmpleado }} {{ itemE.aMEmpleado }}</strong>
                  </h5>
                  <p class="card-text">
                    <strong>Fecha de Ingreso:</strong> {{ itemE.fechaIngreso | date: 'dd/MM/yyyy' }}<br>
                    <strong>Número de Licencia:</strong> {{ itemE.numeroLicencia || 'N/A' }}<br>
                    <strong>Correo:</strong> {{ itemE.correo }}<br>
                    <strong>Teléfono:</strong> {{ itemE.telefono }}<br>
                    <strong>Especialidad:</strong> {{ getEspecialidadNombre(itemE.idEspecialidadFK) }}<br>
                    <strong>Rol:</strong> {{ getRolNombre(itemE.idRolFK) }}<br>
                  </p>
                  <button type="button" class="btn btn-primary" (click)="abrirModalEditar(itemE)">Editar</button>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Modal de Nuevo Empleado -->
          <app-nuevo-empleado
            *ngIf="modalNuevoVisible"
            (crear)="crearEmpleado($event)"
            (cerrarModal)="cerrarModalNuevoEmpleado()">
          </app-nuevo-empleado>
  
          <!-- Modal de Editar Empleado -->
          <app-editar-empleado
            *ngIf="modalEditarVisible && empleadoSeleccionado"
            [empleado]="empleadoSeleccionado"
            (empleadoActualizado)="onEmpleadoActualizado()"
            (cerrarModal)="cerrarModalEditar()">
          </app-editar-empleado>
        </div>
      </div>
    </div>
  </div>
  